---
---
<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="utf-8"/>
    <title>Pitchutcha - Status do Sistema</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base-url" content="{{ '/' | relative_url }}">
    <meta name="jekyll-build-time" content="{{ site.time | date_to_xmlschema }}">
    <meta name="description" content="Acompanhe em tempo real o status e a performance dos serviços do Pitchutcha.">
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="{{ '/css/style.css' | relative_url }}">
    <link rel="icon" href="data:image/x-icon;base64," type="image/x-icon">

    <style>
      /*=============== FONTES PROXIMA NOVA (DO ARQUIVO ORIGINAL) ===============*/
      @font-face {
        font-family: 'proxima-nova';
        src: url('https://dka575ofm4ao0.cloudfront.net/assets/ProximaNovaRegular-366d17769d864aa72f27defaddf591e460a1de4984bb24dacea57a9fc1d14878.eot?host=discordstatus.com');
        src: url('https://dka575ofm4ao0.cloudfront.net/assets/ProximaNovaRegular-366d17769d864aa72f27defaddf591e460a1de4984bb24dacea57a9fc1d14878.eot?host=discordstatus.com#iefix') format('embedded-opentype'),
             url('https://dka575ofm4ao0.cloudfront.net/assets/ProximaNovaRegular-2ee4c449a9ed716f1d88207bd1094e21b69e2818b5cd36b28ad809dc1924ec54.woff?host=discordstatus.com') format('woff');
        font-weight:400;
        font-style:normal;
      }
      @font-face {
        font-family: 'proxima-nova';
        src: url('https://dka575ofm4ao0.cloudfront.net/assets/ProximaNovaSemibold-09566917307251d22021a3f91fc646f3e45f8d095209bcd2cded8a1979f06e54.eot?host=discordstatus.com');
        src: url('https://dka575ofm4ao0.cloudfront.net/assets/ProximaNovaSemibold-09566917307251d22021a3f91fc646f3e45f8d095209bcd2cded8a1979f06e54.eot?host=discordstatus.com#iefix') format('embedded-opentype'),
             url('https://dka575ofm4ao0.cloudfront.net/assets/ProximaNovaSemibold-86724fb2152613d735ba47c3f47a9ad2424b898bea4bece213dacee40344f966.woff?host=discordstatus.com') format('woff');
        font-weight:500;
        font-style:normal;
      }

      /*=============== ESTILOS DOS PAINÉIS (RECRIAÇÃO FIEL) ===============*/
      #discord-status-panel-container {
        font-family: 'proxima-nova', sans-serif;
        color: #2E3338;
      }
      #discord-status-panel-container .components-uptime-link {
        color: #72767d;
        font-size: 14px;
        margin-bottom: 20px;
        display: block;
      }
      #discord-status-panel-container .components-container {
        border: 1px solid #E0E0E0;
        border-radius: 3px;
        overflow: hidden;
        background-color: #FFFFFF; /* Fundo branco para os painéis */
      }
      #discord-status-panel-container .component-container {
        background-color: #FFFFFF;
        border-bottom: 1px solid #E0E0E0;
      }
      #discord-status-panel-container .component-container:last-child {
        border-bottom: none;
      }
      #discord-status-panel-container .component-inner-container {
        padding: 18px 20px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
      }
      #discord-status-panel-container .component-inner-container > .name {
        font-weight: 500;
        color: rgba(46,51,56,.8);
        display: flex;
        align-items: center;
        gap: 8px;
      }
      #discord-status-panel-container .component-inner-container > .name .group-parent-indicator {
        cursor: pointer;
        font-size: 14px;
        color: #72767D;
      }
      #discord-status-panel-container .component-inner-container > .component-status {
        margin-left: auto;
        padding-left: 16px;
        font-weight: 500;
      }
      #discord-status-panel-container .component-inner-container > .icon-indicator {
        padding-left: 16px;
        font-size: 18px;
      }

      #discord-status-panel-container .shared-partial.uptime-90-days-wrapper {
        display: none;
      }
      #discord-status-panel-container .availability-time-line-graphic {
          width: 100%;
          height: 34px;
      }

      @media (min-width: 768px) {
        #discord-status-panel-container .component-inner-container {
          display: grid;
          grid-template-areas: "name status icon" "uptime uptime uptime";
          grid-template-columns: 1fr auto auto;
          gap: 8px 16px;
        }
        #discord-status-panel-container .component-inner-container.showcased {
          grid-template-areas: "name uptime status icon";
          grid-template-columns: 250px 1fr auto auto;
        }
        #discord-status-panel-container .component-inner-container > .name { grid-area: name; }
        #discord-status-panel-container .component-inner-container > .component-status { grid-area: status; padding-left: 0; }
        #discord-status-panel-container .component-inner-container > .icon-indicator { grid-area: icon; padding-left: 0; }
        #discord-status-panel-container .shared-partial.uptime-90-days-wrapper {
          grid-area: uptime;
          display: block;
          min-width: 0;
        }
      }

      #discord-status-panel-container .uptime-90-days-wrapper .legend { display: none; }
      @media (min-width: 768px) {
        #discord-status-panel-container .uptime-90-days-wrapper .legend {
            display: flex; justify-content: space-between; font-size: 12px;
            margin-top: 5px; color: #72767d;
        }
      }
      #discord-status-panel-container .legend .spacer {
        flex: 1 1 0%; height: 1px; background: #e0e0e0; margin: auto 8px;
      }
      
      #discord-status-panel-container .child-components-container {
        display: none; background-color: #fff;
      }
      #discord-status-panel-container .component-container.open > .child-components-container { display: block; }
      #discord-status-panel-container .child-components-container .component-inner-container {
        padding-left: 48px; border-top: 1px solid #f0f0f0;
      }
       
      #discord-status-panel-container .tooltip-base {
          position: relative; display: inline-block; cursor: help; color: #aaa;
          border: 1px solid #aaa; border-radius: 50%; width: 16px; height: 16px;
          line-height: 14px; text-align: center; font-size: 12px; font-weight: 400;
      }
      #discord-status-panel-container .tooltip-base .tooltip-text {
          visibility: hidden; width: 250px; background-color: #2E3338; color: #fff;
          text-align: center; border-radius: 3px; padding: 8px; position: absolute;
          z-index: 10; bottom: 150%; left: 50%; margin-left: -125px; opacity: 0;
          transition: opacity 0.2s ease;
          font-size: 13px; font-weight: 400;
          pointer-events: none;
      }
      #discord-status-panel-container .tooltip-base .tooltip-text::after {
          content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px;
          border-width: 5px; border-style: solid; border-color: #2E3338 transparent transparent transparent;
      }
      #discord-status-panel-container .tooltip-base:hover .tooltip-text { visibility: visible; opacity: 1; }

      #discord-status-panel-container .component-statuses-legend {
         display: flex; flex-wrap: wrap; justify-content: center;
         gap: 15px 25px; margin-top: 30px; font-size: 14px; color: #72767D;
      }
      #discord-status-panel-container .legend-item { display: flex; align-items: center; gap: 8px; }
      
      /* CORES DE STATUS */
      #discord-status-panel-container .status-red, #discord-status-panel-container .icon-indicator.status-red { color:#ED4245; }
      #discord-status-panel-container .status-orange, #discord-status-panel-container .icon-indicator.status-orange { color:#F26522; }
      #discord-status-panel-container .status-yellow, #discord-status-panel-container .icon-indicator.status-yellow { color:#CB8615; }
      #discord-status-panel-container .status-blue, #discord-status-panel-container .icon-indicator.status-blue { color:#3498DB; }
      #discord-status-panel-container .status-green, #discord-status-panel-container .icon-indicator.status-green { color:var(--success); }
    </style>
</head>
<body class="bg-[var(--background-primary)] text-[var(--text-primary)]" style='font-family: Inter, "Noto Sans", sans-serif;'>
    <div class="flex min-h-screen flex-col">
        <header class="sticky top-0 z-20 border-b border-[var(--borders)] bg-[var(--background-primary)]">
            <div class="mx-auto flex max-w-7xl items-center justify-between px-4 sm:px-6 lg:px-8 h-16">
                <div class="flex items-center gap-8">
                    <a class="flex items-center gap-3 text-[var(--text-primary)]" href="{{ '/docs.html' | relative_url }}">
                        <span class="material-symbols-outlined text-3xl text-[var(--primary-color)]"> science </span>
                        <h1 class="text-xl font-bold">Pitchutcha</h1>
                    </a>
                    <nav class="hidden items-center gap-6 md:flex">
                        <a class="text-sm font-medium text-[var(--text-secondary)] hover:text-[var(--primary-color)]" href="{{ '/algoritmos.html' | relative_url }}">Algoritmos</a>
                        <a class="text-sm font-medium text-[var(--text-secondary)] hover:text-[var(--primary-color)]" href="{{ '/estruturas-de-dados.html' | relative_url }}">Estruturas de Dados</a>
                        <a class="text-sm font-medium text-[var(--primary-color)]" href="{{ '/status.html' | relative_url }}">Status</a>
                    </nav>
                </div>
                <div class="flex items-center gap-4">
                    <form class="header-search-form relative hidden lg:block" action="{{ '/search.html' | relative_url }}" method="get">
                        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"> search </span>
                        <input class="h-10 w-full rounded-md border border-[var(--borders)] bg-[var(--background-secondary)] pl-10 pr-4 text-sm text-[var(--text-primary)] placeholder-[var(--text-secondary)] focus:border-[var(--primary-color)] focus:outline-none focus:ring-1 focus:ring-[var(--primary-color)]" placeholder="Pesquisar" type="search" name="q"/>
                    </form>
                </div>
            </div>
        </header>
        <main class="flex-1 px-4 sm:px-6 lg:px-8 py-8">
            <div class="mx-auto max-w-7xl">
                <div class="mb-8">
                    <h1 class="text-3xl font-bold tracking-tight text-[var(--text-primary)]">Status do Sistema</h1>
                    <p class="mt-1 text-[var(--text-secondary)]">Visão geral da saúde dos serviços do Pitchutcha em tempo real.</p>
                </div>
                <div class="mb-8 p-4 rounded-lg bg-[var(--background-secondary)] border border-[var(--borders)]">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-[var(--text-primary)]">Saúde Geral do Site</h2>
                        <div class="flex items-center gap-2 text-sm">
                            <span id="overall-status-indicator" class="relative flex h-3 w-3"></span>
                            <span id="overall-status-text">Verificando status...</span>
                        </div>
                    </div>
                </div>
                <div id="pagespeed-report-container" class="mb-8">
                    <h2 class="text-2xl font-bold tracking-tight text-[var(--text-primary)] mb-4">Relatório PageSpeed Insights</h2>
                    <div class="p-6 bg-[var(--background-secondary)] border border-[var(--borders)] rounded-lg">
                        <p class="text-[var(--text-secondary)]">Carregando relatório...</p>
                    </div>
                </div>
                <div class="mb-8">
                    <h2 class="text-2xl font-bold tracking-tight text-[var(--text-primary)] mb-4">Status Detalhado dos Componentes</h2>
                    <div id="discord-status-panel-container">
                        <div class="p-6 bg-[#FFFFFF] border border-[#E0E0E0] rounded-lg">
                            <p class="text-[#72767d]">Carregando status dos componentes...</p>
                        </div>
                    </div>
                </div>
                <div class="mb-8">
                    <h2 class="text-2xl font-bold tracking-tight text-[var(--text-primary)] mb-4">Tempo de Resposta das Páginas</h2>
                    <div id="performance-monitor-container" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
                </div>
                <div class="mb-8">
                    <h2 class="text-2xl font-bold tracking-tight text-[var(--text-primary)] mb-4">Histórico de Uptime e Incidentes</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div id="uptime-history-container"><p class="text-[var(--text-secondary)]">Carregando dados de uptime...</p></div>
                        <div id="incidents-history-container"><p class="text-[var(--text-secondary)]">Carregando histórico de incidentes...</p></div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="flex flex-col gap-4 rounded-lg p-6 bg-[var(--background-secondary)] border border-[var(--borders)]">
                        <div class="flex items-center justify-between">
                            <p class="text-[var(--text-secondary)] font-medium">Latência da API</p>
                            <span class="material-symbols-outlined text-gray-500">speed</span>
                        </div>
                        <div class="flex items-baseline gap-2">
                            <p id="metric-api-latency" class="text-[var(--text-primary)] text-3xl font-bold">--ms</p>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-lg p-6 bg-[var(--background-secondary)] border border-[var(--borders)]">
                        <div class="flex items-center justify-between">
                            <p class="text-[var(--text-secondary)] font-medium">Tempo de Inferência do Modelo</p>
                            <span class="material-symbols-outlined text-gray-500">model_training</span>
                        </div>
                        <div class="flex items-baseline gap-2">
                            <p id="metric-inference-time" class="text-[var(--text-primary)] text-3xl font-bold">--ms</p>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-lg p-6 bg-[var(--background-secondary)] border border-[var(--borders)]">
                        <div class="flex items-center justify-between">
                            <p class="text-[var(--text-secondary)] font-medium">Taxa de Erros</p>
                            <span class="material-symbols-outlined text-gray-500">error_outline</span>
                        </div>
                        <div class="flex items-baseline gap-2">
                            <p id="metric-error-rate" class="text-[var(--text-primary)] text-3xl font-bold">--%</p>
                        </div>
                    </div>
                </div>
                <div class="mb-8">
                    <h2 class="text-2xl font-bold tracking-tight text-[var(--text-primary)] mb-4">Desempenho dos Modelos</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="flex flex-col gap-4 rounded-lg border border-[var(--borders)] p-6 bg-[var(--background-secondary)]">
                            <p class="text-[var(--text-secondary)] font-medium">Latência da API (Últimas 24h)</p>
                            <p id="chart-avg-latency" class="text-[var(--text-primary)] text-3xl font-bold truncate">Média: --ms</p>
                            <div class="flex-1 flex flex-col justify-center">
                                <svg id="latency-chart-svg" fill="none" height="150" preserveAspectRatio="none" viewBox="0 0 472 150" width="100%" xmlns="http://www.w3.org/2000/svg">
                                    <defs>
                                        <linearGradient gradientUnits="userSpaceOnUse" id="paint0_linear_area" x1="236" x2="236" y1="0" y2="150">
                                            <stop stop-color="var(--primary-color)" stop-opacity="0.3"></stop>
                                            <stop offset="1" stop-color="var(--primary-color)" stop-opacity="0"></stop>
                                        </linearGradient>
                                    </defs>
                                </svg>
                            </div>
                        </div>
                        <div class="flex flex-col gap-4 rounded-lg border border-[var(--borders)] p-6 bg-[var(--background-secondary)]">
                            <p class="text-[var(--text-secondary)] font-medium">Tempo de Inferência por Modelo</p>
                            <p id="chart-avg-inference" class="text-[var(--text-primary)] text-3xl font-bold truncate">Média: --ms</p>
                            <div id="inference-chart-container" class="grid grid-cols-5 gap-4 items-end flex-1 pt-6 px-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        {% include footer.html %}
    </div>

    {% include scripts.html %}

    <script>
    document.addEventListener("DOMContentLoaded", async () => {
        const panelContainer = document.getElementById("discord-status-panel-container");
        const overallStatusIndicator = document.getElementById("overall-status-indicator");
        const overallStatusText = document.getElementById("overall-status-text");
        const baseUrl = document.querySelector('meta[name="base-url"]')?.content || '';

        if (!panelContainer || !overallStatusIndicator || !overallStatusText) {
            console.error("Elementos essenciais do painel de status não foram encontrados.");
            return;
        }

        const statuses = {
            operational: { text: "Operacional", colorClass: "status-green", icon: "fa-check" },
            degraded: { text: "Performance Degradada", colorClass: "status-yellow", icon: "fa-minus-square" },
            partial_outage: { text: "Falha Parcial", colorClass: "status-orange", icon: "fa-exclamation-triangle" },
            major_outage: { text: "Falha Crítica", colorClass: "status-red", icon: "fa-times" },
        };

        async function fetchStatusData() {
            try {
                const response = await fetch(`${baseUrl}component-status.json?cache_bust=${Date.now()}`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                return data.components;
            } catch (error) {
                console.error("Não foi possível carregar os dados de status dos componentes:", error);
                panelContainer.innerHTML = `<div class="p-6 bg-[#FFFFFF] border border-[#E0E0E0] rounded-lg"><p class="text-[#ED4245]">Falha ao carregar o status dos componentes. Verifique o arquivo component-status.json.</p></div>`;
                return null;
            }
        }
        
        function generateUptimeSVG() {
            let svg = `<svg class="availability-time-line-graphic" preserveAspectRatio="none" viewBox="0 0 448 34">`;
            const colors = ['#3BA55C', '#CB8615', '#F26522', '#ED4245']; // Verde, Amarelo, Laranja, Vermelho
            for (let i = 0; i < 90; i++) {
                const rand = Math.random();
                let color = colors[0]; // Padrão é operacional (verde)
                if (rand > 0.98) color = colors[3]; // 2% de chance de falha crítica
                else if (rand > 0.95) color = colors[2]; // 3% de chance de falha parcial
                else if (rand > 0.92) color = colors[1]; // 3% de chance de degradação
                svg += `<rect height="34" width="3" x="${i * 5}" y="0" fill="${color}"></rect>`;
            }
            svg += `</svg>`;
            return svg;
        }

        async function render() {
            const components = await fetchStatusData();
            if (!components) return;

            let overallSystemStatus = 'operational';
            
            const mainPanelHTML = components.map(component => {
                if (component.isGroup) {
                    let groupStatusKey = 'operational';
                    const childrenHTML = component.children.map(child => {
                        const childStatus = child.status || 'operational';
                        if (childStatus === 'major_outage') groupStatusKey = 'major_outage';
                        else if (childStatus === 'partial_outage' && groupStatusKey !== 'major_outage') groupStatusKey = 'partial_outage';
                        else if (childStatus === 'degraded' && groupStatusKey === 'operational') groupStatusKey = 'degraded';
                        
                        const statusInfo = statuses[childStatus];
                        return `
                            <div class="component-inner-container ${statusInfo.colorClass}">
                                <span class="name">${child.name}<span class="tooltip-base">?<span class="tooltip-text">${child.description}</span></span></span>
                                <span class="component-status">${statusInfo.text}</span>
                                <span class="tool icon-indicator fa ${statusInfo.icon} ${statusInfo.colorClass}"></span>
                            </div>
                        `;
                    }).join('');
                    
                    if (groupStatusKey === 'major_outage' || groupStatusKey === 'partial_outage') overallSystemStatus = 'outage';
                    else if (groupStatusKey === 'degraded' && overallSystemStatus === 'operational') overallSystemStatus = 'degraded';
                    
                    const groupStatusInfo = statuses[groupStatusKey];
                    return `
                        <div class="component-container border-color is-group">
                            <div class="component-inner-container ${groupStatusInfo.colorClass}" data-js-hook="component-group-opener">
                                <span class="name"><span class="fa fa-fw group-parent-indicator fa-plus-square-o" role="button"></span> ${component.name}</span>
                                <span class="component-status">${groupStatusInfo.text}</span>
                                <span class="tool icon-indicator fa ${groupStatusInfo.icon} ${groupStatusInfo.colorClass}"></span>
                            </div>
                            <div class="child-components-container">${childrenHTML}</div>
                        </div>
                    `;
                } else {
                    const componentStatus = component.status || 'operational';
                    if (componentStatus === 'major_outage' || componentStatus === 'partial_outage') overallSystemStatus = 'outage';
                    else if (componentStatus === 'degraded' && overallSystemStatus === 'operational') overallSystemStatus = 'degraded';

                    const statusInfo = statuses[componentStatus];
                    return `
                        <div class="component-container border-color">
                            <div class="component-inner-container ${statusInfo.colorClass} showcased">
                                <span class="name">${component.name}<span class="tooltip-base">?<span class="tooltip-text">${component.description}</span></span></span>
                                <span class="component-status">${statusInfo.text}</span>
                                <span class="tool icon-indicator fa ${statusInfo.icon} ${statusInfo.colorClass}"></span>
                                ${component.showUptime ? `
                                <div class="shared-partial uptime-90-days-wrapper">
                                    ${generateUptimeSVG()}
                                    <div class="legend">
                                        <div class="legend-item light">90 dias atrás</div><div class="spacer"></div>
                                        <div class="legend-item">100% uptime</div><div class="spacer"></div>
                                        <div class="legend-item light">Hoje</div>
                                    </div>
                                </div>` : ''}
                            </div>
                        </div>
                    `;
                }
            }).join('');
            
            const legendHTML = `
                <div class="component-statuses-legend">
                    <div class="legend-item"><span class="icon-indicator status-green fa fa-check"></span> Operacional</div>
                    <div class="legend-item"><span class="icon-indicator status-yellow fa fa-minus-square"></span> Performance Degradada</div>
                    <div class="legend-item"><span class="icon-indicator status-orange fa fa-exclamation-triangle"></span> Falha Parcial</div>
                    <div class="legend-item"><span class="icon-indicator status-red fa fa-times"></span> Falha Crítica</div>
                </div>
            `;

            panelContainer.innerHTML = `<div class="components-container">${mainPanelHTML}</div>${legendHTML}`;

            const overallStatusMap = {
                operational: { pulse: "ping-green", dot: "bg-green-500", text: "Todos os sistemas operacionais" },
                degraded: { pulse: "ping-yellow", dot: "bg-yellow-500", text: "Performance degradada" },
                outage: { pulse: "ping-red", dot: "bg-red-500", text: "Falha crítica no sistema" }
            };
            const currentOverallStatus = overallStatusMap[overallSystemStatus];
            overallStatusIndicator.innerHTML = `<span class="relative flex h-3 w-3"><span class="ping-pulse ${currentOverallStatus.pulse}"></span><span class="relative inline-flex rounded-full h-3 w-3 ${currentOverallStatus.dot}"></span></span>`;
            overallStatusText.textContent = currentOverallStatus.text;
            overallStatusText.style.fontFamily = "'proxima-nova', sans-serif";

            const groupOpeners = document.querySelectorAll('[data-js-hook="component-group-opener"]');
            groupOpeners.forEach(opener => {
                opener.addEventListener('click', () => {
                    const parentContainer = opener.closest('.component-container');
                    parentContainer.classList.toggle('open');
                    const indicator = opener.querySelector('.group-parent-indicator');
                    indicator.classList.toggle('fa-plus-square-o');
                    indicator.classList.toggle('fa-minus-square-o');
                });
            });
        }

        render();
    });
    </script>

</body>
</html>
