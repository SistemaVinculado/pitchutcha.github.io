document.addEventListener("DOMContentLoaded",()=>{if(window.self!==window.top){return}const e=document.createElement("script");e.src="js/vendor/axe.min.js",document.head.appendChild(e);const t=`<div id="dev-tools-trigger" class="fixed bottom-4 right-4 z-[100] bg-slate-800 text-white p-3 rounded-full shadow-lg cursor-pointer hover:bg-slate-700 transition-transform hover:scale-110"><span class="material-symbols-outlined">developer_mode</span></div><div id="dev-panel" class="hidden fixed bottom-0 left-0 w-full h-2/3 bg-gray-900 text-white shadow-2xl z-[99] flex flex-col font-mono text-sm"><div class="flex items-center justify-between bg-gray-800 p-2 border-b border-gray-700"><div class="flex items-center gap-4 min-w-0"><h2 class="font-bold text-lg px-2 flex-shrink-0">Pitchutcha Dev Panel</h2><nav class="flex gap-1 overflow-x-auto whitespace-nowrap"><button data-tab="console" class="dev-tab active-tab">Console</button><button data-tab="elements" class="dev-tab">Elements</button><button data-tab="network" class="dev-tab">Network</button><button data-tab="recursos" class="dev-tab">Recursos</button><button data-tab="acessibilidade" class="dev-tab">Acessibilidade</button><button data-tab="testes" class="dev-tab">Testes</button><button data-tab="info" class="dev-tab">Info</button></nav></div><button id="close-dev-panel" class="p-2 rounded-full hover:bg-gray-700"><span class="material-symbols-outlined">close</span></button></div><div id="dev-panel-content" class="flex-1 overflow-auto p-4"></div><div id="console-input-container" class="flex items-center p-2 border-t border-gray-700"><span class="material-symbols-outlined text-sky-400">chevron_right</span><input type="text" id="console-input" class="flex-1 bg-transparent border-none focus:outline-none ml-2" placeholder="Executar JavaScript..."></div></div>`,n=document.createElement("div");n.innerHTML=t,document.body.appendChild(n);const o=document.getElementById("dev-tools-trigger"),c=document.getElementById("dev-panel"),l=document.getElementById("close-dev-panel"),d=document.getElementById("dev-panel-content"),r=document.getElementById("console-input"),s=document.getElementById("console-input-container");o.addEventListener("click",()=>c.classList.toggle("hidden")),l.addEventListener("click",()=>c.classList.add("hidden"));const i=d=>{const t=document.createElement("div");let n="text-white";return"error"===d.type?n="text-red-400":"warn"===d.type?n="text-yellow-400":"info"===d.type&&(n="text-sky-400"),t.className=`console-log-item py-1 px-2 border-b border-gray-800 flex gap-2 ${n}`,t.innerHTML=`<span class="opacity-50">${(new Date).toLocaleTimeString()}</span><div class="flex-1">${d.args.map(e=>"string"==typeof e?e:JSON.stringify(e,null,2)).join(" ")}</div>`,t},a=e=>{d.insertAdjacentElement("beforeend",i(e))};["log","warn","error","info"].forEach(e=>{const t=console[e];console[e]=(...n)=>{t.apply(console,n),a({type:e,args:n})}});r.addEventListener("keydown",e=>{if("Enter"===e.key&&r.value){const t=r.value;r.value="",console.log(`> ${t}`);try{const n=new Function(`return ${t}`)(),o=i({type:"info",args:[n]});o.querySelector("div").classList.add("text-sky-400"),d.appendChild(o)}catch(n){console.error(n.toString())}}d.scrollTop=d.scrollHeight});const u=document.querySelectorAll(".dev-tab");u.forEach(e=>{e.addEventListener("click",()=>{u.forEach(e=>e.classList.remove("active-tab")),e.classList.add("active-tab");const t=e.dataset.tab;d.innerHTML="",s.style.display="console"===t?"flex":"none",p(t)})});const m=(e,t=0)=>{const n=document.createElement("div");n.className="element-node";const o=document.createElement("div");o.className="flex items-center cursor-pointer hover:bg-gray-800",o.style.paddingLeft=`${t}rem`;const c=e.children.length>0?`<span class="material-symbols-outlined text-sm expand-icon">arrow_right</span>`:"<span class='w-4 inline-block'></span>",l=`<span class='text-gray-500'>&lt;</span><span class='text-pink-400'>${e.tagName.toLowerCase()}</span>`;o.innerHTML=`${c}${l}`,n.appendChild(o);const r=document.createElement("div");return r.className="element-children ml-4 hidden",e.children.length>0&&(o.addEventListener("click",e=>{e.stopPropagation(),r.classList.toggle("hidden"),o.querySelector(".expand-icon").textContent=r.classList.contains("hidden")?"arrow_right":"arrow_drop_down"}),[...e.children].forEach(e=>{r.appendChild(m(e,t))})),n.appendChild(r),n},p=e=>{switch(e){case"console":break;case"elements":const t=m(document.documentElement);t.querySelector(".element-children").classList.remove("hidden"),t.querySelector(".expand-icon").textContent="arrow_drop_down",d.appendChild(t);break;case"network":const n=performance.getEntriesByType("navigation")[0];let o="<table class='w-full text-left'><tbody>";o+=`<tr class='border-b border-gray-800'><td class='p-2 font-bold'>Tempo Total de Carregamento</td><td class='p-2'>${n.duration.toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Lookup de DNS</td><td class='p-2'>${(n.domainLookupEnd-n.domainLookupStart).toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Conexão TCP</td><td class='p-2'>${(n.connectEnd-n.connectStart).toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Tempo até Primeiro Byte (TTFB)</td><td class='p-2'>${(n.responseStart-n.requestStart).toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Download do Conteúdo</td><td class='p-2'>${(n.responseEnd-n.responseStart).toFixed(0)} ms</td></tr>`,o+="</tbody></table>",d.innerHTML=o;break;case"recursos":const c=performance.getEntriesByType("resource");let l="<table class='w-full text-left'><thead><tr class='border-b border-gray-700'><th class='p-2'>Nome</th><th class='p-2'>Tipo</th><th class='p-2'>Tamanho (KB)</th><th class='p-2'>Tempo (ms)</th></tr></thead><tbody>";c.forEach(e=>{l+=`<tr class='border-b border-gray-800'><td class='p-2 truncate max-w-xs'>${e.name.split("/").pop()}</td><td class='p-2'>${e.initiatorType}</td><td class='p-2'>${(e.transferSize/1024).toFixed(2)}</td><td class='p-2'>${e.duration.toFixed(0)}</td></tr>`}),l+="</tbody></table>",d.innerHTML=l;break;case"acessibilidade":d.innerHTML='<button id="run-axe" class="dev-button">Rodar Análise de Acessibilidade</button><div id="axe-results" class="mt-4"></div>';break;case"testes":d.innerHTML='<button id="run-tests" class="dev-button">Rodar Testes de Diagnóstico</button><div id="test-results" class="mt-4"></div>';break;case"info":d.innerHTML=`<table class='w-full text-left'><tbody><tr class='border-b border-gray-800'><td class='p-2 font-bold'>User Agent</td><td class='p-2'>${navigator.userAgent}</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Viewport</td><td class='p-2'>${window.innerWidth}px x ${window.innerHeight}px</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Plataforma</td><td class='p-2'>${navigator.platform}</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Linguagem</td><td class='p-2'>${navigator.language}</td></tr></tbody></table>`}const r=document.getElementById("axe-results"),p=document.getElementById("run-axe"),f=document.getElementById("test-results"),h=document.getElementById("run-tests");p&&p.addEventListener("click",async()=>{r.innerHTML="Analisando...",await new Promise(e=>setTimeout(e,100));try{const e=await axe.run({exclude:[["#dev-panel"]]});(e=>{r.innerHTML="";const t=e=>`<div class="p-2 my-1 rounded-md ${"critical"===e.impact||"serious"===e.impact?"bg-red-900 border border-red-700":"bg-yellow-900 border border-yellow-700"}"><p class="font-bold">${e.help} (${e.impact})</p><p class="text-gray-400">${e.description}</p><a href="${e.helpUrl}" target="_blank" class="text-sky-400 hover:underline">Saiba mais</a></div>`,n=e=>`<div class="p-2 my-1 rounded-md bg-green-900 border border-green-700"><p class="font-bold">${e.help}</p></div>`,o=e.violations,c=e.incomplete,l=e.passes;r.insertAdjacentHTML("beforeend",`<h3 class="text-xl font-bold">Resultados (${o.length} violações, ${c.length} revisões, ${l.length} passaram)</h3>`),o.length>0&&(r.insertAdjacentHTML("beforeend",'<h4 class="text-lg font-bold text-red-400 mt-4 mb-2">Violações Críticas/Sérias</h4>'),o.forEach(e=>{const n=t(e);r.insertAdjacentHTML("beforeend",n)})),c.length>0&&(r.insertAdjacentHTML("beforeend",'<h4 class="text-lg font-bold text-yellow-400 mt-4 mb-2">Itens para Revisão Manual</h4>'),c.forEach(e=>{const n=t(e);r.insertAdjacentHTML("beforeend",n)})),l.length>0&&(r.insertAdjacentHTML("beforeend",`<h4 class="text-lg font-bold text-green-400 mt-4 mb-2">Testes Aprovados (${l.length})</h4>`),l.forEach(e=>{const t=n(e);r.insertAdjacentHTML("beforeend",t)})),0===o.length&&0===c.length&&r.insertAdjacentHTML("beforeend",'<p class="text-green-400 font-bold text-center mt-4">Parabéns! Nenhum problema de acessibilidade encontrado.</p>')})(e)}catch(s){console.error(s),r.innerHTML=`<p class="text-red-500">${s.message}</p>`}}),h&&h.addEventListener("click",async()=>{f.innerHTML="";const e=["css/style.css","js/script.js","js/dev-panel.js","index.html","algoritmos.html","estruturas-de-dados.html","search.html","status.html"];for(const t of e){let e,n;try{const o=await fetch(t,{method:"HEAD",cache:"no-store"});o.ok?(e="success",n="Arquivo encontrado e acessível."):(e="error",n=`Falha ao carregar o arquivo (Status: ${o.status}).`)}catch(o){e="error",n="Erro de rede."}g(t,e,n)}})};const g=(e,t,n)=>{const o="success"===t?"text-green-400":"text-red-400",c=`<div class="flex items-center gap-2 p-1 border-b border-gray-800 ${o}"><span class="material-symbols-outlined">${"success"===t?"check_circle":"error"}</span><span class="font-bold">${e}:</span><span>${n}</span></div>`;d.querySelector("#test-results").insertAdjacentHTML("beforeend",c)};window.onerror=(e,t,n,o,c)=>{const l=`Erro: ${e} em ${t}:${n}`;a({type:"error",args:[l]})}});
