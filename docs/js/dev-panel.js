document.addEventListener("DOMContentLoaded",(()=>{if(window.self!==window.top)return;const e=document.createElement("script");e.src="js/vendor/axe.min.js",document.head.appendChild(e);const t=document.createElement("div");t.innerHTML='<div id="dev-tools-trigger" class="fixed bottom-4 right-4 z-[100] bg-slate-800 text-white p-3 rounded-full shadow-lg cursor-pointer hover:bg-slate-700 transition-transform hover:scale-110"><span class="material-symbols-outlined">developer_mode</span></div><div id="dev-panel" class="hidden fixed bottom-0 left-0 w-full h-2/3 bg-gray-900 text-white shadow-2xl z-[99] flex flex-col font-mono text-sm"><div class="flex items-center justify-between bg-gray-800 p-2 border-b border-gray-700"><div class="flex items-center gap-4 min-w-0"><h2 class="font-bold text-lg px-2 flex-shrink-0">Pitchutcha Dev Panel</h2><nav class="flex gap-1 overflow-x-auto whitespace-nowrap"><button data-tab="console" class="dev-tab active-tab">Console</button><button data-tab="elements" class="dev-tab">Elements</button><button data-tab="network" class="dev-tab">Network</button><button data-tab="recursos" class="dev-tab">Recursos</button><button data-tab="acessibilidade" class="dev-tab">Acessibilidade</button><button data-tab="testes" class="dev-tab">Testes</button><button data-tab="info" class="dev-tab">Info</button></nav></div><button id="close-dev-panel" class="p-2 rounded-full hover:bg-gray-700"><span class="material-symbols-outlined">close</span></button></div><div id="dev-panel-content" class="flex-1 overflow-auto p-4"></div><div id="console-input-container" class="flex items-center p-2 border-t border-gray-700"><span class="material-symbols-outlined text-sky-400">chevron_right</span><input type="text" id="console-input" class="flex-1 bg-transparent border-none focus:outline-none ml-2" placeholder="Executar JavaScript..."></div></div>',document.body.appendChild(t);const o=document.getElementById("dev-tools-trigger"),n=document.getElementById("dev-panel"),c=document.getElementById("close-dev-panel"),d=document.getElementById("dev-panel-content"),l=document.getElementById("console-input"),s=document.getElementById("console-input-container");o.addEventListener("click",(()=>{n.classList.toggle("hidden")})),c.addEventListener("click",(()=>{n.classList.add("hidden")}));const i=e=>{const t=document.createElement("div");let o="text-white";return"error"===e.type?o="text-red-400":"warn"===e.type?o="text-yellow-400":"info"===e.type&&(o="text-sky-400"),t.className=`console-log-item py-1 px-2 border-b border-gray-800 flex gap-2 ${o}`,t.innerHTML=`<span class="opacity-50">${(new Date).toLocaleTimeString()}</span><div class="flex-1">${e.args.map((e=>"string"==typeof e?e:JSON.stringify(e,null,2))).join(" ")}</div>`,t},a=e=>{d.insertAdjacentElement("beforeend",i(e))};["log","warn","error","info"].forEach((e=>{const t=console[e];console[e]=(...o)=>{t.apply(console,o),a({type:e,args:o})}})),l.addEventListener("keydown",(e=>{if("Enter"===e.key&&l.value){const t=l.value;l.value="",console.log(`> ${t}`);try{const e=(new Function(`return ${t}`))(),o=i({type:"info",args:[e]});o.querySelector("div").classList.add("text-sky-400"),d.appendChild(o)}catch(e){console.error(e.toString())}}d.scrollTop=d.scrollHeight}));const r=document.querySelectorAll(".dev-tab");r.forEach((e=>{e.addEventListener("click",(()=>{r.forEach((e=>e.classList.remove("active-tab")))),e.classList.add("active-tab");const t=e.dataset.tab;d.innerHTML="",s.style.display="console"===t?"flex":"none",u(t)}))}));const u=e=>{switch(e){case"console":break;case"elements":const e=m(document.documentElement);e.querySelector(".element-children").classList.remove("hidden"),e.querySelector(".expand-icon").textContent="arrow_drop_down",d.appendChild(e);break;case"network":const t=performance.getEntriesByType("navigation")[0];let o="<table class='w-full text-left'><tbody>";o+=`<tr class='border-b border-gray-800'><td class='p-2 font-bold'>Tempo Total de Carregamento</td><td class='p-2'>${t.duration.toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Lookup de DNS</td><td class='p-2'>${(t.domainLookupEnd-t.domainLookupStart).toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Conexão TCP</td><td class='p-2'>${(t.connectEnd-t.connectStart).toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Tempo até Primeiro Byte (TTFB)</td><td class='p-2'>${(t.responseStart-t.requestStart).toFixed(0)} ms</td></tr>`,o+=`<tr class='border-b border-gray-800'><td class='p-2'>Download do Conteúdo</td><td class='p-2'>${(t.responseEnd-t.responseStart).toFixed(0)} ms</td></tr>`,o+="</tbody></table>",d.innerHTML=o;break;case"recursos":const n=performance.getEntriesByType("resource");let c="<table class='w-full text-left'><thead><tr class='border-b border-gray-700'><th class='p-2'>Nome</th><th class='p-2'>Tipo</th><th class='p-2'>Tamanho (KB)</th><th class='p-2'>Tempo (ms)</th></tr></thead><tbody>";n.forEach((e=>{c+=`<tr class='border-b border-gray-800'><td class='p-2 truncate max-w-xs'>${e.name.split("/").pop()}</td><td class='p-2'>${e.initiatorType}</td><td class='p-2'>${(e.transferSize/1024).toFixed(2)}</td><td class='p-2'>${e.duration.toFixed(0)}</td></tr>`})),c+="</tbody></table>",d.innerHTML=c;break;case"acessibilidade":d.innerHTML='<button id="run-axe" class="dev-button">Rodar Análise de Acessibilidade</button><div id="axe-results" class="mt-4"></div>';break;case"testes":d.innerHTML='<button id="run-tests" class="dev-button">Rodar Testes de Diagnóstico</button><div id="test-results" class="mt-4"></div>';break;case"info":d.innerHTML=`<table class='w-full text-left'><tbody><tr class='border-b border-gray-800'><td class='p-2 font-bold'>User Agent</td><td class='p-2'>${navigator.userAgent}</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Viewport</td><td class='p-2'>${window.innerWidth}px x ${window.innerHeight}px</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Plataforma</td><td class='p-2'>${navigator.platform}</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Linguagem</td><td class='p-2'>${navigator.language}</td></tr></tbody></table>`}const l=document.getElementById("axe-results"),s=document.getElementById("run-axe"),i=document.getElementById("test-results"),a=document.getElementById("run-tests");s&&s.addEventListener("click",(async()=>{l.innerHTML="Analisando...",await new Promise((e=>setTimeout(e,100)));try{const e=await axe.run({exclude:[["#dev-panel"]]});(e=>{l.innerHTML="";const t=e=>`<div class="p-2 my-1 rounded-md ${"critical"===e.impact||"serious"===e.impact?"bg-red-900 border border-red-700":"bg-yellow-900 border border-yellow-700"}"><p class="font-bold">${e.help} (${e.impact})</p><p class="text-gray-400">${e.description}</p><a href="${e.helpUrl}" target="_blank" class="text-sky-400 hover:underline">Saiba mais</a></div>`,o=e=>`<div class="p-2 my-1 rounded-md bg-green-900 border border-green-700"><p class="font-bold">${e.help}</p></div>`,n=e.violations,c=e.incomplete,d=e.passes;l.insertAdjacentHTML("beforeend",`<h3 class="text-xl font-bold">Resultados (${n.length} violações, ${c.length} revisões, ${d.length} passaram)</h3>`),n.length>0&&(l.insertAdjacentHTML("beforeend",'<h4 class="text-lg font-bold text-red-400 mt-4 mb-2">Violações Críticas/Sérias</h4>'),n.forEach((e=>{const o=t(e);l.insertAdjacentHTML("beforeend",o)}))),c.length>0&&(l.insertAdjacentHTML("beforeend",'<h4 class="text-lg font-bold text-yellow-400 mt-4 mb-2">Itens para Revisão Manual</h4>'),c.forEach((e=>{const o=t(e);l.insertAdjacentHTML("beforeend",o)}))),d.length>0&&(l.insertAdjacentHTML("beforeend",`<h4 class="text-lg font-bold text-green-400 mt-4 mb-2">Testes Aprovados (${d.length})</h4>`),d.forEach((e=>{const t=o(e);l.insertAdjacentHTML("beforeend",t)}))),0===n.length&&0===c.length&&l.insertAdjacentHTML("beforeend",'<p class="text-green-400 font-bold text-center mt-4">Parabéns! Nenhum problema de acessibilidade encontrado.</p>')})(e)}catch(e){console.error(e),l.innerHTML=`<p class="text-red-500">${e.message}</p>`}})),a&&a.addEventListener("click",(async()=>{i.innerHTML="";const e=["css/style.css","js/script.js","js/dev-panel.js","index.html","algoritmos.html","estruturas-de-dados.html","search.html","status.html"];for(const t of e){let e,o;try{const n=await fetch(t,{method:"HEAD",cache:"no-store"});n.ok?(e="success",o="Arquivo encontrado e acessível."):(e="error",o=`Falha ao carregar o arquivo (Status: ${n.status}).`)}catch(t){e="error",o="Erro de rede."}p(t,e,o)}}))},m=(e,t=0)=>{const o=document.createElement("div");o.className="element-node";const n=document.createElement("div");n.className="flex items-center cursor-pointer hover:bg-gray-800",n.style.paddingLeft=`${t}rem`;const c=e.children.length>0?'<span class="material-symbols-outlined text-sm expand-icon">arrow_right</span>':"<span class='w-4 inline-block'></span>",d=`<span class='text-gray-500'>&lt;</span><span class='text-pink-400'>${e.tagName.toLowerCase()}</span>`;n.innerHTML=`${c}${d}`,o.appendChild(n);const l=document.createElement("div");return l.className="element-children ml-4 hidden",e.children.length>0&&(n.addEventListener("click",(e=>{e.stopPropagation(),l.classList.toggle("hidden"),n.querySelector(".expand-icon").textContent=l.classList.contains("hidden")?"arrow_right":"arrow_drop_down"})),[...e.children].forEach((e=>{l.appendChild(m(e,t))}))),o.appendChild(l),o},p=(e,t,o)=>{const n="success"===t?"text-green-400":"text-red-400",c=`<div class="flex items-center gap-2 p-1 border-b border-gray-800 ${n}"><span class="material-symbols-outlined">${"success"===t?"check_circle":"error"}</span><span class="font-bold">${e}:</span><span>${o}</span></div>`;d.querySelector("#test-results").insertAdjacentHTML("beforeend",c)};window.onerror=(e,t,o,n,c)=>{const d=`Erro: ${e} em ${t}:${o}`;a({type:"error",args:[d]})}}));
