document.addEventListener("DOMContentLoaded",()=>{if(window.self!==window.top){return}const e=document.createElement("script");e.src="js/vendor/axe.min.js",document.head.appendChild(e);const t=`<div id="dev-tools-trigger" class="fixed bottom-4 right-4 z-[100] bg-slate-800 text-white p-3 rounded-full shadow-lg cursor-pointer hover:bg-slate-700 transition-transform hover:scale-110"><span class="material-symbols-outlined">developer_mode</span></div><div id="dev-panel" class="hidden fixed bottom-0 left-0 w-full h-2/3 bg-gray-900 text-white shadow-2xl z-[99] flex flex-col font-mono text-sm"><div class="flex items-center justify-between bg-gray-800 p-2 border-b border-gray-700"><div class="flex items-center gap-4 min-w-0"><h2 class="font-bold text-lg px-2 flex-shrink-0">Pitchutcha Dev Panel</h2><nav class="flex gap-1 overflow-x-auto whitespace-nowrap"><button data-tab="elements" class="dev-tab active-tab">Elements</button><button data-tab="console" class="dev-tab">Console</button><button data-tab="storage" class="dev-tab">Storage</button><button data-tab="network" class="dev-tab">Network</button><button data-tab="recursos" class="dev-tab">Recursos</button><button data-tab="acessibilidade" class="dev-tab">Acessibilidade</button><button data-tab="testes" class="dev-tab">Testes</button><button data-tab="info" class="dev-tab">Info</button></nav></div><button id="close-dev-panel" class="p-2 rounded-full hover:bg-gray-700"><span class="material-symbols-outlined">close</span></button></div><div id="dev-panel-content" class="flex-1 overflow-auto flex"></div><div id="console-input-container" class="hidden items-center p-2 border-t border-gray-700"><span class="material-symbols-outlined text-sky-400">chevron_right</span><input type="text" id="console-input" class="flex-1 bg-transparent border-none focus:outline-none ml-2" placeholder="Executar JavaScript..."></div></div>`,n=document.createElement("div");n.innerHTML=t,document.body.appendChild(n);const o=document.getElementById("dev-tools-trigger"),c=document.getElementById("dev-panel"),l=document.getElementById("close-dev-panel"),d=document.getElementById("dev-panel-content"),r=document.getElementById("console-input"),s=document.getElementById("console-input-container"),a=document.querySelectorAll(".dev-tab");let i=!1,u=null;o.addEventListener("click",()=>{c.classList.toggle("hidden"),c.classList.contains("hidden")||p("elements")}),l.addEventListener("click",()=>c.classList.add("hidden")),a.forEach(e=>{e.addEventListener("click",()=>{a.forEach(e=>e.classList.remove("active-tab")),e.classList.add("active-tab"),p(e.dataset.tab)})});function p(e){panelContent.innerHTML="",s.style.display="console"===e?"flex":"none";switch(e){case"elements":g();break;case"console":b();break;case"storage":v();break;case"network":E();break;case"recursos":S();break;case"acessibilidade":L();break;case"testes":x();break;case"info":C()}}function g(){d.innerHTML=`<div id="elements-tree-container" class="w-1/2 overflow-auto p-2 border-r border-gray-700"></div><div id="styles-container" class="w-1/2 overflow-auto p-2"><div class="flex items-center gap-2 mb-2"><button id="inspector-toggle" class="p-1 rounded hover:bg-gray-700" title="Inspecionar um elemento na página"><span class="material-symbols-outlined">ads_click</span></button><h3 class="font-bold">Computed Styles</h3></div><div id="computed-styles-container">Clique em um elemento para ver os estilos.</div></div>`;const e=document.getElementById("elements-tree-container");e.appendChild(y(document.documentElement));const t=document.getElementById("inspector-toggle");t.addEventListener("click",k)}function b(){d.innerHTML='<div id="console-output" class="flex-1 overflow-y-auto p-2"></div>'}function v(){let e="";for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t),o=localStorage.getItem(n);e+=`<tr class='border-b border-gray-800'><td class='p-2 align-top text-orange-400'>${n}</td><td class='p-2 align-top text-green-400 whitespace-pre-wrap break-all'>${o}</td></tr>`}d.innerHTML=`<div class="p-2 w-full"><h3 class="font-bold text-lg mb-2">Local Storage</h3><table class="w-full text-left text-xs"><thead><tr class="border-b border-gray-700"><th class="p-2 w-1/4">Key</th><th class="p-2">Value</th></tr></thead><tbody>${e}</tbody></table></div>`}function E(){const e=performance.getEntriesByType("navigation")[0];d.innerHTML=`<div class="p-4 w-full"><table class='w-full text-left'><tbody><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Tempo Total de Carregamento</td><td class='p-2'>${e.duration.toFixed(0)} ms</td></tr><tr class='border-b border-gray-800'><td class='p-2'>Lookup de DNS</td><td class='p-2'>${(e.domainLookupEnd-e.domainLookupStart).toFixed(0)} ms</td></tr><tr class='border-b border-gray-800'><td class='p-2'>Conexão TCP</td><td class='p-2'>${(e.connectEnd-e.connectStart).toFixed(0)} ms</td></tr><tr class='border-b border-gray-800'><td class='p-2'>Tempo até Primeiro Byte (TTFB)</td><td class='p-2'>${(e.responseStart-e.requestStart).toFixed(0)} ms</td></tr><tr class='border-b border-gray-800'><td class='p-2'>Download do Conteúdo</td><td class='p-2'>${(e.responseEnd-e.responseStart).toFixed(0)} ms</td></tr></tbody></table></div>`}function S(){const e=performance.getEntriesByType("resource");let t="";e.forEach(e=>{t+=`<tr class='border-b border-gray-800'><td class='p-2 truncate max-w-xs'>${e.name.split("/").pop()}</td><td class='p-2'>${e.initiatorType}</td><td class='p-2'>${(e.transferSize/1024).toFixed(2)}</td><td class='p-2'>${e.duration.toFixed(0)}</td></tr>`}),d.innerHTML=`<div class="p-4 w-full"><table class='w-full text-left'><thead><tr class='border-b border-gray-700'><th class='p-2'>Nome</th><th class='p-2'>Tipo</th><th class='p-2'>Tamanho (KB)</th><th class='p-2'>Tempo (ms)</th></tr></thead><tbody>${t}</tbody></table></div>`}function L(){d.innerHTML='<div class="p-4"><button id="run-axe" class="dev-button">Rodar Análise de Acessibilidade</button><div id="axe-results" class="mt-4"></div></div>',document.getElementById("run-axe").addEventListener("click",A)}function x(){d.innerHTML='<div class="p-4"><button id="run-tests" class="dev-button">Rodar Testes de Diagnóstico</button><div id="test-results" class="mt-4"></div></div>',document.getElementById("run-tests").addEventListener("click",P)}function C(){d.innerHTML=`<div class="p-4 w-full"><table class='w-full text-left'><tbody><tr class='border-b border-gray-800'><td class='p-2 font-bold'>User Agent</td><td class='p-2'>${navigator.userAgent}</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Viewport</td><td class='p-2'>${window.innerWidth}px x ${window.innerHeight}px</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Plataforma</td><td class='p-2'>${navigator.platform}</td></tr><tr class='border-b border-gray-800'><td class='p-2 font-bold'>Linguagem</td><td class='p-2'>${navigator.language}</td></tr></tbody></table></div>`}r.addEventListener("keydown",e=>{if("Enter"===e.key&&r.value){const t=r.value;r.value="",m({type:"log",args:[`> ${t}`]});try{const n=new Function(`return ${t}`)();m({type:"info",args:[n]})}catch(o){m({type:"error",args:[o.toString()]})}}});function m(e){const t=document.getElementById("console-output");if(!t)return;let n="text-white";"error"===e.type?n="text-red-400":"warn"===e.type?n="text-yellow-400":"info"===e.type&&(n="text-sky-400");const o=document.createElement("div");o.className=`console-log-item py-1 px-2 border-b border-gray-800 flex gap-2 ${n}`,o.innerHTML=`<span class="opacity-50">${(new Date).toLocaleTimeString()}</span><div class="flex-1">${e.args.map(e=>"string"==typeof e?e:JSON.stringify(e,null,2)).join(" ")}</div>`,t.appendChild(o),t.scrollTop=t.scrollHeight}["log","warn","error","info"].forEach(e=>{const t=console[e];console[e]=(...n)=>{t.apply(console,n),m({type:e,args:n})}});function y(e){const t=document.createElement("div");function n(e,l){const d=document.createElement("div"),r=document.createElement("div");r.className="flex items-center cursor-pointer hover:bg-gray-800 rounded p-0.5",r.style.paddingLeft=`${l}rem`;const s=Array.from(e.attributes).map(e=>`<span class="text-orange-400">${e.name}</span><span class="text-gray-500">="</span><span class="text-green-400">${e.value}</span><span class="text-gray-500">"</span>`).join(" "),a=e.children.length>0?`<span class="material-symbols-outlined text-sm expand-icon">arrow_right</span>`:"<span class='w-4 inline-block'></span>`;r.innerHTML=`${a}<span class='text-gray-500'>&lt;</span><span class='text-pink-400'>${e.tagName.toLowerCase()}</span> <span class="attributes">${s}</span><span class='text-gray-500'>&gt;</span>`;const i=document.createElement("div");i.className="element-children hidden",d.appendChild(r),d.appendChild(i),r.addEventListener("click",t=>{t.stopPropagation(),i.classList.toggle("hidden"),r.querySelector(".expand-icon").textContent=i.classList.contains("hidden")?"arrow_right":"arrow_drop_down",f(e),h(e)});for(const u of e.children)i.appendChild(n(u,l+1));return d}return t.appendChild(n(e,0)),t}function h(e){const t=document.getElementById("computed-styles-container");if(!t)return;const n=window.getComputedStyle(e),o=Array.from(n).filter(e=>!e.startsWith("-")).sort();let c="<table class='w-full text-left text-xs'>";o.forEach(e=>{c+=`<tr class='border-b border-gray-800'><td class='p-1 text-pink-400'>${e}</td><td class='p-1 text-cyan-400'>${n.getPropertyValue(e)}</td></tr>`}),c+="</table>",t.innerHTML=c}function f(e){u&&(u.style.outline=""),e.style.outline="2px solid #0ea5e9",u=e}function k(e){e.stopPropagation(),i=!i;const t=e.currentTarget;t.style.backgroundColor=i?"#0ea5e9":"transparent",t.style.color=i?"white":"#9ca3af",document.body.style.cursor=i?"crosshair":"default",i?(document.addEventListener("mouseover",w),document.addEventListener("click",_,{capture:!0})):(document.removeEventListener("mouseover",w),document.removeEventListener("click",_,{capture:!0}),u&&(u.style.outline=""))}function w(e){e.target.closest("#dev-panel")||f(e.target)}function _(e){if(!i)return;e.preventDefault(),e.stopPropagation();const t=e.target;h(t),i=!1;const n=document.getElementById("inspector-toggle");n&&(n.style.backgroundColor="transparent",n.style.color="#9ca3af"),document.body.style.cursor="default",document.removeEventListener("mouseover",w),document.removeEventListener("click",_,{capture:!0}),u&&(u.style.outline="")}async function A(){const e=document.getElementById("axe-results");e.innerHTML="Analisando...";try{const t=await axe.run({exclude:[["#dev-panel"]]}),n=t.violations,o=t.incomplete,c=t.passes;e.innerHTML="",e.insertAdjacentHTML("beforeend",`<h3 class="text-xl font-bold">Resultados (${n.length} violações, ${o.length} revisões, ${c.length} passaram)</h3>`),n.length>0&&(e.insertAdjacentHTML("beforeend",'<h4 class="text-lg font-bold text-red-400 mt-4 mb-2">Violações Críticas/Sérias</h4>'),n.forEach(t=>e.insertAdjacentHTML("beforeend",`<div class="p-2 my-1 rounded-md bg-red-900 border border-red-700"><p class="font-bold">${t.help} (${t.impact})</p><p class="text-gray-400">${t.description}</p><a href="${t.helpUrl}" target="_blank" class="text-sky-400 hover:underline">Saiba mais</a></div>`))),o.length>0&&(e.insertAdjacentHTML("beforeend",'<h4 class="text-lg font-bold text-yellow-400 mt-4 mb-2">Itens para Revisão Manual</h4>'),o.forEach(t=>e.insertAdjacentHTML("beforeend",`<div class="p-2 my-1 rounded-md bg-yellow-900 border border-yellow-700"><p class="font-bold">${t.help} (${t.impact})</p><p class="text-gray-400">${t.description}</p><a href="${t.helpUrl}" target="_blank" class="text-sky-400 hover:underline">Saiba mais</a></div>`))),c.length>0&&(e.insertAdjacentHTML("beforeend",`<h4 class="text-lg font-bold text-green-400 mt-4 mb-2">Testes Aprovados (${c.length})</h4>`),c.forEach(t=>e.insertAdjacentHTML("beforeend",`<div class="p-2 my-1"><p class="font-bold">${t.help}</p></div>`))),0===n.length&&0===o.length&&e.insertAdjacentHTML("beforeend",'<p class="text-green-400 font-bold text-center mt-4">Parabéns! Nenhum problema de acessibilidade encontrado.</p>')}catch(l){e.innerHTML=`<p class="text-red-500">${l.message}</p>`}}async function P(){const e=document.getElementById("test-results");e.innerHTML="";const t=["css/style.css","js/script.js","js/dev-panel.js","index.html","algoritmos.html","estruturas-de-dados.html","search.html","status.html"];for(const n of t){let t,o;try{const c=await fetch(n,{method:"HEAD",cache:"no-store"});c.ok?(t="success",o="Arquivo encontrado e acessível."):(t="error",o=`Falha ao carregar (Status: ${c.status}).`)}catch(l){t="error",o="Erro de rede."}const c="success"===t?"text-green-400":"text-red-400";e.insertAdjacentHTML("beforeend",`<div class="flex items-center gap-2 p-1 border-b border-gray-800 ${c}"><span class="material-symbols-outlined">${"success"===t?"check_circle":"error"}</span><span class="font-bold">${n}:</span><span>${o}</span></div>`)}}window.onerror=(e,t,n,o,c)=>{m({type:"error",args:[`Erro: ${e} em ${t}:${n}`]})}});
