document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("search-input"),t=document.getElementById("results-container"),n=document.getElementById("results-count"),c=document.querySelectorAll('input[data-filter="category"]');let o=[];async function a(){try{const r=await fetch("search.json");if(!r.ok)throw new Error("Falha ao carregar search.json");o=await r.json();const l=new URLSearchParams(window.location.search).get("q");l&&(e.value=l),s()}catch(r){console.error(r),n.textContent="Erro ao carregar artigos."}}function i(o,a){if(t.innerHTML="",0===o.length)return void(n.textContent="Nenhum resultado encontrado.");n.textContent=`Mostrando ${o.length} resultados.`;o.forEach(n=>{let o=n.title,s=n.excerpt;if(a){const e=new RegExp(a,"gi");o=o.replace(e,e=>`<mark>${e}</mark>`),s=s.replace(e,e=>`<mark>${e}</mark>`)}const r=document.createElement("div");r.className="bg-white p-6 rounded-md shadow-sm border border-gray-200 hover:shadow-md transition-shadow",r.innerHTML=`
                <a class="block" href="${n.url}">
                    <h3 class="text-lg font-semibold text-gray-900 hover:text-[var(--primary-color)]">${o}</h3>
                    <p class="text-sm text-gray-500 mt-1">Categoria: <span class="font-medium text-gray-700">${n.category}</span></p>
                    <p class="text-gray-600 mt-2 text-sm">${s}</p>
                </a>
            `,t.appendChild(r)})}function s(){const t=e.value.toLowerCase().trim(),n=Array.from(c).filter(e=>e.checked).map(e=>e.value);const a=o.filter(e=>{const c=t?e.title.toLowerCase().includes(t)||e.excerpt.toLowerCase().includes(t):!0,o=0===n.length||n.includes(e.category);return c&&o});i(a,t)}e&&(e.addEventListener("input",s),c.forEach(e=>{e.addEventListener("change",s)}),a())});
