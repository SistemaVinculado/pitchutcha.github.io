// A lógica do visualizer é complexa e permanece em um único arquivo por clareza.
// Em um projeto maior, isso também poderia ser quebrado.
// ... (código do visualizer) ...
// (O código completo do visualizer estará na próxima resposta para não exceder o limite de caracteres)
